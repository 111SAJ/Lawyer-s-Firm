@model List<Contact>

@{
    ViewData["Title"] = "Admin Emails Page";
}

<button id="scrollToTopBtn" title="Go to top">
    <i class="fa-solid fa-up-long"></i>
</button>

<!-- admin-section 1 starts -->
<div class="container pt-lg-5 pb-lg-5 pattern-cls">
    <div class="dot-pattern"></div>
    <div class="text-right">
        <form asp-controller="Login" asp-action="Logout" method="post">
            <button type="submit" class="button shadow">Logout <i class="fa-solid fa-right-from-bracket" style="color: #800000;"></i></button>
        </form>
    </div>
    <h3 class="text-center pb-3 pt-5 gradient-text">EMAILS</h3>
    <div class="text-center">
        <p class="b-crumb" style="color: #000;"><a asp-controller="Admin" asp-action="Index" style="color: #000;"><i class="fa-solid fa-house mr-2" style="color: #000;"></i>Admin</a> / Email</p>
    </div>
    <div class="row p3" style="border: 1px solid rgba(139, 69, 19, 0.062);">
        <div class="col p-3">
            <form id="searchForm" method="get" asp-action="Index">
                <div class="input-group flex-nowrap">
                    <input type="text" class="form-control" placeholder="Search By Name / Email / Phone" name="searchQuery" value="@ViewBag.SearchQuery" aria-label="Search">
                    <button class="btn-sm btn-outline-secondary" type="submit" style="background-color: transparent; border: 1px solid gray;">
                        <i class="fa-solid fa-magnifying-glass fa-fade" style="color: #800000;"></i>
                    </button>
                    <button class="btn-sm btn-outline-secondary" type="button" style="background-color: transparent; border: 1px solid gray;" onclick="clearSearch()">
                        <i class="fa-solid fa-broom" style="color: #800000;"></i>
                    </button>
                </div>
            </form>
            @if (Model == null || !Model.Any())
        {
            <p class="text-center">You have no emails.</p>
        }
        else
        {
            @foreach (var contact in Model)
            {
                <div class="shadow p-3 mb-3 mt-3">
                    <p class="font-weight-bold">@contact.Name</p>
                    <p>@contact.Email <span class="font-weight-bold">|</span> @contact.Phone</p>
                    <p style="font-size:12px">@contact.CreatedOn</p>
                    <p>@contact.Message</p>
                </div>
            }
        }
            <!-- Pagination -->
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    @if (ViewBag.TotalCount > 0)
                    {
                        <li class="page-item @(ViewBag.Page == 1 ? "disabled" : "")">
                            <a class="page-link" href="@Url.Action("Index", new { page = 1, searchQuery = ViewBag.SearchQuery })">First</a>
                        </li>
                        <li class="page-item @(ViewBag.Page == 1 ? "disabled" : "")">
                            <a class="page-link" href="@Url.Action("Index", new { page = ViewBag.Page - 1, searchQuery = ViewBag.SearchQuery })">&lt;</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="#">Page @(ViewBag.Page) of @Math.Ceiling(ViewBag.TotalCount / (double)ViewBag.PageSize)</a>
                        </li>
                        <li class="page-item @(ViewBag.Page >= Math.Ceiling(ViewBag.TotalCount / (double)ViewBag.PageSize) ? "disabled" : "")">
                            <a class="page-link" href="@Url.Action("Index", new { page = ViewBag.Page + 1, searchQuery = ViewBag.SearchQuery })">&gt;</a>
                        </li>
                        <li class="page-item @(ViewBag.Page >= Math.Ceiling(ViewBag.TotalCount / (double)ViewBag.PageSize) ? "disabled" : "")">
                            <a class="page-link" href="@Url.Action("Index", new { page = Math.Ceiling(ViewBag.TotalCount / (double)ViewBag.PageSize), searchQuery = ViewBag.SearchQuery })">Last</a>
                        </li>
                    }
                </ul>
            </nav>

        </div>
    </div>
</div>
<!-- admin-section 1 ends -->

<script>
    function clearSearch() {
        document.querySelector('input[name="searchQuery"]').value = '';
        document.getElementById('searchForm').submit();
    }
</script>